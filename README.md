# Face Detection using Convolutional Neural Networks

## Introduction
Face detection is a necessary first-step in face recognition systems, with the purpose of localizing and extracting the face region from the background. It also has several applications in areas such as content-based image retrieval, video coding, video conferencing, crowd surveillance, facial expression recognition, face tracking, facial feature extraction, gender classification, identification system, document control and access control, clustering, biometric science, human computer interaction (HCI) system, digital cosmetics and many more. A face detector should tell whether an image of arbitrary size contains a human face and if so, where it is present in the image.

## Structure of the Project
The project is divided into two parts: the first is an in-depth survey of convolutional neural networks, and the second part is where we develop our own CNN to detect faces in images.
We used the Labeled Faces in the Wild dataset provided by UMass as the positive samples for training. There are a total of 14,103 images in this dataset. As for the negative samples, we collected images from various sources like the negative training set of the INRIA dataset, the Caltech 101 dataset and the Street View House Numbers (SVHN) dataset. Since we wanted our training dataset to be balanced, we considered 14,103 images for the negative samples as well.

    This project was done in Python 3.6
    The examples directory contains various test images and the outputs generated by our classifier.

## Requirements to run:
- TensorFlow and Keras
- OpenCV
- matplotlib
- imutils
- numpy

## Sample inputs and outputs
![Example 1](https://github.com/csaiprashant/face_detection_cnn/blob/master/examples/a.png)
![Example 2](https://github.com/csaiprashant/face_detection_cnn/blob/master/examples/d.png)

## Files in the Repository
- /examples/<x.png> - example outputs from the trained CNN
- Accuracy and Loss plot.png - Plot showing training accuracy and loss of the CNN
- face.model - trained neural network
- projectreport.pdf - Full project report
- README.md
- test_multiple_face.py - Tests the entire test image for multiple faces. Utilizes sliding window and image pyramid techniques to detect faces at various locations in the image
    - Usage: python test_network.py --model face.model --image "path to image"
- test_single_face.py - Tests the test image for a single face. The face should be the SOLE CONTENT of the image. Useful for testing and debugging the model in early stages.
    - Usage: python test_single_face.py --model face.model --image "path to image"
- train_network.py - Trains a CNN. Cannot be run now as we did not provide the training dataset(due to large size of the dataset).

### For full report, please refer [Project Report](https://github.com/csaiprashant/face_detection_cnn/blob/master/projectreport.pdf)
